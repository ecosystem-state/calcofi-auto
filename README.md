<!-- README.md is generated from README.Rmd. Please edit that file -->

<!-- badges: start -->

[![Make
grid](https://github.com/ecosystem-state/calcofi-auto/workflows/R-gen-grid/badge.svg)](https://github.com/ecosystem-state/calcofi-auto/actions)

[![R-gen-index](https://github.com/ecosystem-state/calcofi-auto/actions/workflows/R-gen-indices.yaml/badge.svg)](https://github.com/ecosystem-state/calcofi-auto/actions/workflows/R-gen-indices.yaml)

[![Run DFA
models](https://github.com/ecosystem-state/calcofi-auto/workflows/R-run-dfa/badge.svg)](https://github.com/ecosystem-state/calcofi-auto/actions)
<!-- badges: end -->

## Overview

This repository is a demonstration of automatic index generation using
data from CalCOFI and ERDDAP. The index is generated by applying Dynamic
Factor Analysis (DFA) to the top \~ 50 species, using spring samples
collected 1985 - present.

If youâ€™re looking for data:  
\* time series (with uncertainty) are in
[indices/predicted_indices_sdmtmb.rds](https://github.com/ecosystem-state/calcofi-auto/blob/main/indices/predicted_indices_sdmtmb.rds)  
\* the prediction grid is in [indices/pred_grid.rds](https://github.com/ecosystem-state/calcofi-auto/blob/main/indices/pred_grid.rds)  
\* estimated DFA trends are in [data/index_data.rds](https://github.com/ecosystem-state/calcofi-auto/blob/main/data/index_data.rds)

## Results

We find that a model with 3 trends has better predictive accuracy than a
model with 1-2 trends.

![Estimated trends for the CalCOFI community](figures/trends.jpeg)

![Estimated loadings for the CalCOFI community](figures/loadings.jpeg)

![Predicted and observed fits to the CalCOFI data](figures/fitted.jpeg)

## bayesdfa

For more on the approach used, check out the [bayesdfa R
package](https://fate-ewi.github.io/bayesdfa/)
